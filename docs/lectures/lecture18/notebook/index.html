<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed|Roboto:300,400,700" rel="stylesheet">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css">

    <link rel="stylesheet" href="../../../style/tipuesearch/tipuesearch.css">

    <link rel='shortcut icon' type='image/x-icon' href='../../../style/images/favicon.ico' />
    <link rel="stylesheet" href="../../../style/css/hiacs.css">

    <title>CS109B - Lecture 18 Notebook</title>

    <style>
      .navbar {
        background-color: #A51C30
      }
    </style>
  </head>
  <body>

<nav class="navbar navbar-dark navbar-expand-md">
  <div class="container">
    <a class="navbar-brand" href="../../..">
      <img class="navbar-brand-logo" src="../../../style/images/logo.png" />
      <h3 class="course-title">CS109B</h3>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsDefault" aria-controls="navbarsDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarsDefault">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="../../../pages/syllabus.html">Syllabus</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../../../pages/schedule.html">Schedule</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../../../pages/materials.html">Materials</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../../../pages/modules.html">Modules</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../../../pages/github.html">GitHub</a>
        </li>
        <form
          class="form-inline my-2"
          action="../../../search.html"
          onsubmit="return validateForm(this.elements['q'].value);"
        >
          <div class="input-group input-group-sm">
            <input class="form-control" type="text" name="q" placeholder="Search Topic">
            <div class="input-group-append">
              <button class="btn btn-default" type="submit">
                <i class="fas fa-search"></i>
              </button>
            </div>
        </div>
      </form>
      </ul>
    </div><!-- .collapse navbar-collapse -->
  </div><!-- .container -->
</nav>
    <main id="content" class="container">
    <div>
      <div class="float-left">
        <p>Key Word(s):
          <a href="../../../pages/materials.html#Autoencoders">Autoencoders</a>        </p>
      </div>
      <div class="float-right">
        <a href="https://github.com/Harvard-IACS/2019-CS109B/blob/master/content/lectures/lecture18/notes/cs109b-lecture18-example.ipynb">
          Download Notebook <i class="fas fa-download"></i>
        </a>
      </div>
    </div>
    <br />
    <hr />
  <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1><img src="https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/iacs.png" style="float: left; padding-right: 10px; width: 45px" /> CS109B Data Science 2: Advanced Topics in Data Science</h1>
<h2 id="Lecture-18:-Autoencoders-Example">Lecture 18: Autoencoders Example<a class="anchor-link" href="#Lecture-18:-Autoencoders-Example">¶</a></h2><p><strong>Harvard University</strong><br />
<strong>Spring 2019</strong><br />
<strong>Instructors:</strong> Pavlos Protopapas and Mark Glickman<br /></p>
<hr style="height:2pt" />
<p>Code and ideas taken/borrowed/adapted from 
Deep Learning From Basics to Practice, by Andrew Glassner, <a href="https://dlbasics.com">https://dlbasics.com</a>, <a href="http://glassner.com">http://glassner.com</a>, Python utilities for saving and loading files, mostly images and Keras model weights</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#RUN THIS CELL </span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="k">import</span> <span class="n">HTML</span>
<span class="n">styles</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css"</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">styles</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[11]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<style>
blockquote { background: #AEDE94; }
h1 { 
    padding-top: 25px;
    padding-bottom: 25px;
    text-align: left; 
    padding-left: 10px;
    background-color: #DDDDDD; 
    color: black;
}
h2 { 
    padding-top: 10px;
    padding-bottom: 10px;
    text-align: left; 
    padding-left: 5px;
    background-color: #EEEEEE; 
    color: black;
}

div.exercise {
	background-color: #ffcccc;
	border-color: #E9967A; 	
	border-left: 5px solid #800080; 
	padding: 0.5em;
}

span.sub-q {
	font-weight: bold;
}
div.theme {
	background-color: #DDDDDD;
	border-color: #E9967A; 	
	border-left: 5px solid #800080; 
	padding: 0.5em;
	font-size: 18pt;
}
div.gc { 
	background-color: #AEDE94;
	border-color: #E9967A; 	 
	border-left: 5px solid #800080; 
	padding: 0.5em;
	font-size: 12pt;
}
p.q1 { 
    padding-top: 5px;
    padding-bottom: 5px;
    text-align: left; 
    padding-left: 5px;
    background-color: #EEEEEE; 
    color: black;
}
header {
   padding-top: 35px;
    padding-bottom: 35px;
    text-align: left; 
    padding-left: 10px;
    background-color: #DDDDDD; 
    color: black;
}
</style>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.datasets</span> <span class="k">import</span> <span class="n">mnist</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">Sequential</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Dense</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1">#import h5py</span>
<span class="c1">#from pathlib import Path</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">keras</span> <span class="k">import</span> <span class="n">backend</span> <span class="k">as</span> <span class="n">keras_backend</span>
<span class="n">keras_backend</span><span class="o">.</span><span class="n">set_image_data_format</span><span class="p">(</span><span class="s1">'channels_last'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># I will be saving everything so I can re-use them </span>
<span class="n">save_files</span> <span class="o">=</span> <span class="kc">True</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">inspect</span>
<span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getfile</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">current_dir</span><span class="p">))</span> <span class="c1"># path to parent dir</span>
<span class="kn">from</span> <span class="nn">DLBasics_Utilities</span> <span class="k">import</span> <span class="n">File_Helper</span>
<span class="n">file_helper</span> <span class="o">=</span> <span class="n">File_Helper</span><span class="p">(</span><span class="n">save_files</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">random_seed</span> <span class="o">=</span> <span class="mi">52</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>

<span class="c1"># Read MNIST data. Of course we will not be using y_train and y_test</span>
<span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="c1"># Full size of the image 28x28 </span>
<span class="n">N_pixels</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Convert to floats</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">keras_backend</span><span class="o">.</span><span class="n">cast_to_floatx</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">keras_backend</span><span class="o">.</span><span class="n">cast_to_floatx</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Normalize the range from [0,255] to [0,1]</span>
<span class="n">X_train</span> <span class="o">/=</span> <span class="mf">255.</span>
<span class="n">X_test</span> <span class="o">/=</span> <span class="mf">255.</span>

<span class="c1"># Reshape the data into a grid with one row per sample, each row 784 (28*28) pixels</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="n">N_pixels</span><span class="p">))</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">N_pixels</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"X_train.shape = "</span><span class="p">,</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">" X_test.shape = "</span><span class="p">,</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>X_train.shape =  (60000, 784)  X_test.shape =  (10000, 784)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">draw_predictions_set</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">file_helper</span><span class="o">.</span><span class="n">save_figure</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">'-predictions'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Build and train our first autoencoder</span>
<span class="n">num_latent_vars</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">modelAE1</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">modelAE1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_latent_vars</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">N_pixels</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">modelAE1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">N_pixels</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">))</span>
<span class="n">modelAE1</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adadelta'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'mse'</span><span class="p">)</span>


<span class="n">weights_filename</span> <span class="o">=</span> <span class="s2">"modelAE1-weights"</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">file_helper</span><span class="o">.</span><span class="n">load_model_weights</span><span class="p">(</span><span class="n">modelAE1</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">):</span>
    <span class="n">modelAE1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span>
                   <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                   <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">))</span>
    <span class="n">file_helper</span><span class="o">.</span><span class="n">save_model_weights</span><span class="p">(</span><span class="n">modelAE1</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 0.0309 - val_loss: 0.0305
Epoch 2/20
 - 2s - loss: 0.0308 - val_loss: 0.0304
Epoch 3/20
 - 2s - loss: 0.0308 - val_loss: 0.0304
Epoch 4/20
 - 2s - loss: 0.0307 - val_loss: 0.0303
Epoch 5/20
 - 2s - loss: 0.0307 - val_loss: 0.0303
Epoch 6/20
 - 2s - loss: 0.0307 - val_loss: 0.0303
Epoch 7/20
 - 2s - loss: 0.0307 - val_loss: 0.0303
Epoch 8/20
 - 2s - loss: 0.0307 - val_loss: 0.0303
Epoch 9/20
 - 2s - loss: 0.0306 - val_loss: 0.0303
Epoch 10/20
 - 2s - loss: 0.0306 - val_loss: 0.0303
Epoch 11/20
 - 2s - loss: 0.0306 - val_loss: 0.0302
Epoch 12/20
 - 2s - loss: 0.0306 - val_loss: 0.0302
Epoch 13/20
 - 2s - loss: 0.0306 - val_loss: 0.0302
Epoch 14/20
 - 2s - loss: 0.0306 - val_loss: 0.0302
Epoch 15/20
 - 2s - loss: 0.0306 - val_loss: 0.0302
Epoch 16/20
 - 2s - loss: 0.0306 - val_loss: 0.0302
Epoch 17/20
 - 2s - loss: 0.0306 - val_loss: 0.0302
Epoch 18/20
 - 2s - loss: 0.0306 - val_loss: 0.0302
Epoch 19/20
 - 3s - loss: 0.0306 - val_loss: 0.0302
Epoch 20/20
 - 2s - loss: 0.0306 - val_loss: 0.0302
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions1</span> <span class="o">=</span> <span class="n">modelAE1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">draw_predictions_set</span><span class="p">(</span><span class="n">predictions1</span><span class="p">,</span> <span class="s1">'FCC1'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjgAAAD3CAYAAAAQVC6+AAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4wLCBo
dHRwOi8vbWF0cGxvdGxpYi5vcmcvpW3flQAAIABJREFUeJzt3XuwlVX9x/F1BORmoQJy05BziDuI
qKQZpGaGiooCwsQ0lTNZTU7OaFhmTWUXZ2zGpovh9EcTXYaaVBxJM6hUtCAluQaIXA8GBAgiF0nB
8/vn5/Kzvp5n9ZzN3vvsZ+3366/vdj3s/Zy9nufZy/Vdl4aWlhYHAACQkpPa+wQAAADKjQYOAABI
Dg0cAACQHBo4AAAgOTRwAABAcmjgAACA5NDAAQAAyaGBAwAAkkMDBwAAJKdjWw5uaGhg2eN21NLS
0nCi70Edti/qsPiow+KjDosvTx3SgwMAAJJDAwcAACSHBg4AAEgODRwAAJAcGjgAACA5NHAAAEBy
aOAAAIDk0MABAADJadNCf0C5fOlLXwped+3a1cdjxowJyqZNm9bqe8yZMyd4vWTJEh//6le/OtFT
BAAUGD04AAAgOTRwAABAcmjgAACA5DS0tOTfL4zNxdpX0TeI+93vfufjrHE1J2LTpk0+vvzyy4Oy
5ubmsn9eKYpeh5U2ZMgQH69fvz4ou/XWW3384x//uGrnZNVLHXbv3j14/f3vf9/Hn/3sZ338z3/+
Mzhu+vTpPt62bVuFzu7E1EsdpozNNgEAQF2igQMAAJLDNHFUjKaknMuflrKpiT/96U8+bmxs9PE1
11wTHNfU1OTjWbNmBWX33HNPrs9G+zr33HN9/NZbbwVlL7/8crVPp67169cveP2Zz3zGx1o35513
XnDc5MmTfXz//fdX6OzwtnHjxgWvH374YR+fffbZFf3sK664Ini9bt06H2/fvr2in50HPTgAACA5
NHAAAEByaOAAAIDkMAYHZXX++ef7+Prrr8887l//+lfw+tprr/Xx3r17g7JDhw75+OSTT/bx0qVL
g+POOeccH/fs2TPnGaOWjB071seHDx8OyubPn1/t06k7vXv39vHcuXPb8UyQ18c+9rHgdefOnav2
2XYc5E033eTjmTNnVu08stCDAwAAkkMDBwAAJKfdU1Q6dVinIe7YsSM47ujRoz7+zW9+E5Tt2rXL
xxs3biz3KaINdGppQ0O40KSmpWy36s6dO3O9/+233+7jESNGZB732GOP5Xo/tK9Ro0YFr2+55RYf
syN85X3xi18MXk+ZMsXH48ePL+k9J06c6OOTTgr/H3rlypU+Xrx4cUnvD+c6dnznp/uqq65qt/Ow
q1jfdtttPtaVsG26uVrowQEAAMmhgQMAAJLT7imqe++918d5V13Ujd6cc+7gwYM+trNzKk1XV9W/
ZdmyZVU9j1qxYMECHw8ePDgo03rat29fSe+vI/M7depU0nugdgwbNix4rd3adiVslN8PfvCD4LVd
PboUN9xwQ6uxc+HmmzNmzAjKbLoD2S699FIfX3TRRUGZ/g5V2mmnnRa81mED3bp18zEpKgAAgDKh
gQMAAJJDAwcAACSn3cfg6NTwMWPG+Fh3JXXOueHDh/vY7p56ySWX+PjCCy8MynRH07POOivXOR07
dix4vWfPHh/bHXZVc3Ozj+t1DI7SfPuJmD17to+HDBmSedw//vGPVmPUrjvuuCN4rdcM91BlPP74
4z6207hL8corrwSvdeXxgQMHBmWDBg3y8XPPPReUdejQ4YTPJVV2OYV58+b5eNOmTUHZ9773vaqc
k3POXXfddVX7rFLQgwMAAJJDAwcAACSn3VNUf/nLX1qNrSeeeCKzTKeq6WZ9zoVTDy+44IJc56Sr
Jjvn3IYNG3xsU2enn366j21XIUozefLk4PXdd9/tY91sc/fu3cFxd955p4+PHDlSobPDidLlIHRz
VufCe629ppam5sMf/nDweujQoT6208LzThN/4IEHfLxw4cKg7MCBAz6+7LLLgrK77ror8z0///nP
+3jOnDm5zqNefO1rXwte63IKkyZNCso0RVgJ+ptnr61yLDNQTvTgAACA5NDAAQAAyaGBAwAAktPu
Y3DKYf/+/T5+8sknM4+LjfGJmTp1qo/t0tSrV6/2MUvLl4cdl6HjbpT9vp9++umKnRPKx+btlS7J
gNLpOKff/va3QVmvXr1yvYdd5uGhhx7y8be+9S0fx8a72fe4+eabfdy7d++gTLcY6NKli49/8pOf
BMe9+eabsdNOxrRp03xsdwzfuHGjj6u9nIKOo7Jjbp566ikfv/rqq9U6pUz04AAAgOTQwAEAAMlJ
IkVVbmeccUbw+qc//amP7cqfOoW51B2y4dwjjzzi4yuuuCLzuF/+8pc+tlMnUQyjR4/OLKvmTsgp
69jxnUd73pSUc2Gad+bMmUHZ3r1723weNkV1zz33+Pi+++4LynT3ab0OHn300eC4elmOY/r06T7W
78a58Dep0jTd6Zxzs2bN8vHx48eDsu985zs+roVUIj04AAAgOTRwAABAcmjgAACA5DAGpxVf+MIX
gtc6nVGnpDvn3IsvvliVc0qN3ZX9gx/8oI87d+4clGnuX3O8lV6SHOVz4YUX+vjTn/60j5cvXx4c
t2jRoqqdE949xfimm27ycSljbv4XHU+jYzmcy7+VTsp69OjhY71nrGpuZaFT+50Lx3TZrYtiy7S0
B3pwAABAcmjgAACA5JCi+n8XX3yxj7/yla9kHjdlypTg9Zo1ayp2TinTVVGdc65nz56Zx/7617/2
cb1MEU3N5Zdf7mPdjfiJJ54Ijjt69GjVzqle2KUt1Ac+8IEqnolzDQ0NPrbnlXWe3/zmN4PXn/jE
J8p+XrVC0/MDBgzw8bx589rjdJxzzjU1NWWW1frvHz04AAAgOTRwAABAckhR/T/dzKxTp05BmW7S
uWTJkqqdU2quvfZaH48bNy7zON2wzTnnvvGNb1TqlFAl55xzjo9bWlp8/OCDD7bH6STvc5/7nI/t
hojt6ZprrvHxueeeG5TpeWpsU1QpO3jwoI9XrFjh4zFjxgTHaZq3Eivo62r+uumn9eyzz5b9s8uJ
HhwAAJAcGjgAACA5NHAAAEBy6nYMTteuXYPXkyZN8vEbb7wRlOkYkFrYIbUo7NTvr371qz6245yU
5p6dY8XiIurbt2/wesKECT7W1b/nz59ftXOqJzrWpdp05fcRI0YEZfoMiNmzZ4+P6+mZ+/rrr/tY
l8SYOnVqcNxjjz3mY7sre16jRo3ycWNjY1CmO4jrmDmrlsZ3tYYeHAAAkBwaOAAAIDl1m6KaPXt2
8FqnLNrVVf/+979X5ZxSc/vttwevY5vpPfLIIz5mWnjxfepTnwpe67TTP/7xj1U+G1TTXXfd5WO7
cXHM1q1bffzJT37Sx83NzWU5r6LR56CuAO2cc1dffbWPS13lWDdTtWko3VAz5he/+EVJn10t9OAA
AIDk0MABAADJoYEDAACSU1djcDRv+fWvfz0oe+2113x89913V+2cUnbbbbflPvaWW27xMdPCi2/g
wIGZZfv376/imaDSHn/88eD10KFDS3qftWvX+rjWtwCohvXr1/v4xhtvDMrGjh3r48GDB5f0/rFt
UubOnevjWbNmZR6n09prET04AAAgOTRwAABAcpJPUelquj/60Y983KFDh+A47WZdunRp5U8MAd0d
t9SVSw8cOJD5Hrpyco8ePTLf49RTT/VxW1Jsx48f9/GXv/zloOzIkSO53ycVkydPzixbsGBBFc+k
Pum04pNOyv7/2CuvvDKz7Gc/+1nwun///q0eZ9+/1NVt23P15aLR1d7tyu/lsHnz5lzH6WrIzjm3
Zs2asp/LiaAHBwAAJIcGDgAASA4NHAAAkJzkxuDYsTW67cKgQYN8rDu1OvfuaeOorlWrVp3we/z+
97/38c6dO4OyPn36+HjGjBkn/Fkxu3btCl5/97vfrejn1YoPfehDPra7iaO65syZ4+N7770387g/
/OEPwevY+Jm8Y2vyHvfAAw/kOg7Vp2O47DYRqtbG3Fj04AAAgOTQwAEAAMlJLkXV1NQUvD7vvPNa
Pc5OAbYpK5w4u8LpddddV9HPmz59ekn/7tixYz6Oda8/+uijPl62bFnmcc8880xJ51F0119/vY9t
qnj58uU+Xrx4cdXOqV49/PDDPp49e3ZQ1rt374p+9p49e3y8bt26oOzmm2/2sU0jo3bo7uJ2p/Ei
oQcHAAAkhwYOAABIThIpKt3Yb+HChZnHaVetnT2A8rvhhhuC13fccYePdWXh/2XkyJE+zjsD6uc/
/3nweuvWrZnHPvTQQz7WDe4Q161bt+D1VVddlXmsbuynqz6jMrZt2+bjmTNnBmVTpkzx8a233lr2
z9ZZg/fff3/Z3x+V16VLl8yyWt9gU9GDAwAAkkMDBwAAJIcGDgAASE5DW6aANTQ01OR8Mc353nnn
nZnHjR8/3sexab61qqWlJXtJyZxqtQ7rRUp1aMdRPf300z7evXt3UPbxj3/cx0XfXT2lOpw0aVLw
Wqdx2929dZkE3WncrnS7du1aHzc3N5flPMstpTqsBF2NvWPHcKjut7/9bR//8Ic/rNo5WXnqkB4c
AACQHBo4AAAgOYVMUemmfs6FK+aecsopmf+OFFXt1GG9og6LjzosPuowbsGCBT6+7777grInn3yy
2qfTKlJUAACgLtHAAQAAyaGBAwAAklPIrRomTJgQvI6Nu9Fdwg8dOlSxcwIAIAV2iYCiogcHAAAk
hwYOAABITiFTVDErV64MXn/kIx/x8b59+6p9OgAAoB3QgwMAAJJDAwcAACSHBg4AAEhOIbdqqFcs
L1581GHxUYfFRx0WH1s1AACAukQDBwAAJKet08T3Oue2VeJE8D8NLNP7UIfthzosPuqw+KjD4stV
h20agwMAAFAEpKgAAEByaOAAAIDk0MABAADJoYEDAACSQwMHAAAkhwYOAABIDg0cAACQHBo4AAAg
OTRwAABAcmjgAACA5NDAAQAAyaGBAwAAkkMDBwAAJIcGDgAASA4NHAAAkBwaOAAAIDk0cAAAQHJo
4AAAgOTQwAEAAMmhgQMAAJJDAwcAACSHBg4AAEgODRwAAJAcGjgAACA5NHAAAEByaOAAAIDk0MAB
AADJoYEDAACSQwMHAAAkhwYOAABIDg0cAACQHBo4AAAgOTRwAABAcmjgAACA5HRsy8ENDQ0tlToR
/G8tLS0NJ/oe1GH7og6LjzosPuqw+PLUIT04AAAgOW3qwQHaQ0PDOw31lhb+pwmoBr3v7OvYfcg9
Wrtsnb4t1TqjBwcAACSHBg4AAEgODRwAAJAcxuCgarLyv7bspJPCdre+1uPs+2UdZ7311lvB6+PH
j7ca2+NSzVOXS6xusrTlO2UMSOV16NDBx506dQrK9LUeFxurY++hY8eO+VjvtViZrU/qN36vxZ6l
WWW2nvS1/b5jZbWGHhwAAJAcGjgAACA5hUxR5e3+dq72u9BSo3Wj3djOOdex4zuX28knnxyUdenS
JbMsqztc36+11+rNN9/08euvvx6UHTlyxMdHjx5t9d849+4u9XoQSwPa7u9Y2kLvw0p0cWe9J+mN
eD3ZNFS3bt18fMoppwRlWfeofQ/9jvV+ci681w4dOhSU/fe//23132nqql7F7kP73MtKJdp/F0v5
6utYKtHWTSzF3x7owQEAAMmhgQMAAJJDAwcAACSnpsbg5J0CbHOONsesNEf4xhtvnOgpwr27bjTP
27lzZx937949OO7UU0/1ce/evYOynj17+vj0008Pyk477TQfv/e97/WxvQ60fvfu3RuUvfzyyz5u
bm4Oyv7zn//4WMfd2PxyyltGZE0ftTl8ze/bsRdaH7Zu9H00jt279jvWMRp2fJSW6XVgxw8UaYpr
W2U9P21d6FiaHj16BGV6H/bp0yco69+/v4/1/tVxO86FdbF79+6gbNu2bT7evHlzULZnzx4fp1xP
pYh9B7FlNex4Ri2LjaXRz7PPAH3G29+CrN9b+9tbrbE69OAAAIDk0MABAADJqXqKKpZ6ik1f1G5V
22Wm72m7rrVrTLvCmHrYNlpPsamlmk7q27dvcNzAgQN9/L73vS8o69evn4/POOOMoEy7yrVr3KbA
XnnlFR+vXr06KNNpp9pN7lw4dVWnkNfCNMdKiaUZNaVh61q7vGP3YaxLXd/Dpki0+9t2a7/22ms+
3r9/f1CW1eUdO4/YVPYi0vOP1UVsuQatD01JOedcY2OjjwcMGOBjO51c7yF9bjvn3L59+zLP/+DB
g5ll9c6mGfWZa1OEWh96PzkXpg+1LuyUfb2H3vOe9wRlOtTAPoP1PtT3tO+v14j9zS7nc5ceHAAA
kBwaOAAAIDk0cAAAQHKqMgYnNsVbc4Rdu3b1sc0r6mubo9PxFXbKnL6/ToG0Yvl9ZE8Fdy7M2+tY
Gs3ZOxeOu9Hp3s6F4wS0LpwLrwutQzt+QPPBdtyB5vd37doVlNnPS1Vsl+G8Y3BUbMsLOz1b718d
l2GvA83v2zE4et/bZQD0GdCWKbUqtgt20ej5279Fv1c7DkmXaBg8eHBQ9v73v9/Heh/aZ7rWha3D
HTt2+Dh2bdWL2Fg4fb7ZcTA6FtH+rumx9v11nKI+92LXux0bpZ9nx9Dp/aW/E/aejE1RL+dyHPTg
AACA5NDAAQAAyalIisp2A2tXm51SqF3SvXr1ajV2LuzW1qluzoVd47a7VN9Hpx/bNIt2w+mKmrbM
dstrma7a+eqrrwbHxVZhrcXpqbHp/DY1FJuyqPT7eemll4Iy/c7t9ONBgwb5eOzYsa3+d+fCrvEN
GzYEZevXr2/1POqVrd8sNsUQu45jtBtau7XPPPPM4Di9X23XuE41tddI3nvI/jtVtLSUfc5mnb99
Juozd9SoUUHZRz/6UR9PmDAhKNPnp14Xhw8fDo7T9KR93muZTTPqtaWrjRetXqy8aSjnwuenpoLO
Ouus4Lizzz7bx3ZVeGWHW2hayu70npeev01R6WtdId5eI3ovV3K5BnpwAABAcmjgAACA5JQtRRVb
6VZnt9iNFHXWjXa72dVstSvPpqi029N21+nqubr6pu323Llzp491pLlzYZecHfGtmziuXLnSx5oS
cS7sji3iBoCxke3aXR1L5+nspY0bN+b+7PHjx/tYUxi2+1u7X7du3RqU2dWL6529BpVej21JQ8Vo
d7vOprNpRlunSp8xsfPP+jetvVa1cu/FNh3O2rTUufA70Wewri7unHPnn3++j2fOnBmUTZs2LfP9
laYYbKpDz8OudKt1P2zYsKBMV9bVujhw4EBwnD5XbAq1VuowtmGtDrew17veJ01NTT4eMWJEcJyW
2eEW+pv073//OyjT79L+jmax76+/o/qb7VxY33od2GEfMcyiAgAAiKCBAwAAkkMDBwAAJKdsY3A0
b2anJepKtDbnqGNyNLa5Wx0XYPPoOrXOTlvTz9PxM3aqsI7RsHlvXZHXrhqp+dTt27f72I5D0lyi
Hf9TK3njGD1HOy5Dc+I6zsZOA7U7ymax353meWOrIevn2XFU7FQcv840X16O6zGWt9ep4bEprvY6
0zrMu/q0vZdjqxXX4nTk2JIbtkyfRfrMteMkLr30Uh/feOONQVne5QPWrFnjYzueTsd22HtUx+vY
z9IVePv06eNj/VucC8fq2N3J7RjJ9qJ/m32e6d9jv5+sleB1FWnnwrGIdmV2/S2zy2XosXnH4Ghd
OBeO/xk+fHhQpvdsbDkOfcbY5w3TxAEAACJo4AAAgORUZbPNvOmZ2NRDLbNTA7U73HZd6/Rv/Xd2
2rB2p9ku3axN5uz7a/eoPX/97KKlpJwL6812A2tXp67gbFevzOvKK68MXuuKqiNHjvSxTYVu2rTJ
x7qKZrnodM+805SLotzXpF2JXFfP1dh20evKq3YVVu1ez5uKiHV/FzFVHJtCrs9B/V6HDBkSHDdx
4sTM94hZtGiRjxcuXOhjXXXYuTAFY5f70HvWPqt1WEIsRaV1b1PPtZKiisnakNK58N7QIRv2OJ12
vWrVqqBs2bJlPrbLZdhhA3nYOhw6dKiP7TIP+nuoz0j7m62prEqmhunBAQAAyaGBAwAAkkMDBwAA
JKdsY3A0f23HJ2j+zY5N0Ty75uXscTq2w05v02niOlXSuTDfqe9hc5Ox7R40L2pzobqTuf4tsR12
iyg2PkHroxzjbq6++uqgTHcQ79+/v4/t8t+aX7a7leel14+d3qnXZ2yMUhFUYgdfvU/sfaivdesA
O45Kx1TYZeZ37NjR5nOyy+THxpzU4hgce13pGBN7ferfpstl2CnGOoYi5oUXXgheL1iwwMdLlizx
sT5XnXOub9++Ptbno3Nh3du60X8XW+ZfnzG2zG4PUwtsHcZ+C7K2x7BjZ7Zs2eLjpUuXBmXr1q3z
canPY2V/D3WMqh2TqttExLbtqdbzkh4cAACQHBo4AAAgORVJUcWmEdsuS11xVnc6tdP/NP1ju7fs
NEKl5xLb0VTfw3bp6iqsNj2mqS7tUs+70mpRxFaetOnEPHRHY+ecu+yyy3xspx7aHejfZrvGtS7y
rtLpXNg1rivFxv4ue40XIUXVlinBedjVxjV9a68RPVZXrLXfm65Mq1NOWzs2D9vlrynrcn8f5ZJ3
xenY36apA31+ORd/Xuo9NH/+/KBs8eLFPtaVjGNTnXX4gHNhusPucq7XiN57tt51uQC9X2uJnrNN
SemzI5a+0t9Kuwq8pqF0eQznypOWUvb3UIcJWJpK03s5ljq0K3KXczgHPTgAACA5NHAAAEByaOAA
AIDkVGQMjs0hx7Yw0PybTsO1u8TGcnh2LEYpRo8e7eMLLrggKNNc8fPPPx+UaS5Ux+AUYUxGqWyO
1O76nEVz88OGDQvKdBqxXaJfp8Nqvt9O9dcxG3bXel26Xnckt++puW67G64ud1Cr4zcqTe9XmzvX
cU/2+9d7SL9ve+1oHZa63YaOTYlNEy9CHca2mrDfv4530XtNxzw5Fz5b7TU+b948Hz/44INB2fr1
61s9RzuuUsfF2GX+dTyHHVun/07HY9rrQJ8HRa/D2LH6vdoxnTp2tRLbU4waNcrH9lmtz1I7Tm77
9u0+1uvMbtVQrfuQHhwAAJAcGjgAACA5FdlNPDb1zXZJazecTm+r9IqUtgtdV9LVHaudC9MWa9eu
Dcp0xVw7tT0lsV2Y89Lp2LZ7fePGjT7evHlzUKbTEjWVZadHaqrSTo3VHZUbGxuDMr3W9D1tfer1
WYSucSuW3si7iq/WvZ2Kr6kDu8qupkz0s206UldCLTX1rKkOu1Kynr/9m7VOa3FVY8tOz9aUj37f
NoWxfPlyH+uKxM45N3fuXB9v27atpPPS799OSdfrwu4kr6/1+7dTzVWt1lPeXevt+etvpT6XbB1q
2nHgwIFBmf5e2SnjmvrT9K1drXjChAk+ttPE9d/Z9KFO4df71w5riC3XUM77kB4cAACQHBo4AAAg
ORVJUcU2IrQpKn1d7hUYY+yGjhMnTvSxTV+tWLHCx6tXrw7KdNR4ymJdhdpVrl2P2k3uXLgBoM4C
cC7cSNF2Z2pXp3Z/v/jii8FxOqLfdrn269fPx3alZJ2hoJ9lz1HTHZXsVq0Ge/5ab3lTkHZmRKzu
tUtdu7jtJoKaoiqVXo92FlXeGX+1Sr9j+5zS71xXBbapVr3X/vrXvwZlpaallF5bNs2oq8nrPelc
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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Build and train our first autoencoder</span>
<span class="n">num_latent_vars</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">modelAE1_s</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">modelAE1_s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_latent_vars</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">N_pixels</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">modelAE1_s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">N_pixels</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>
<span class="n">modelAE1_s</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adadelta'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'binary_crossentropy'</span><span class="p">)</span>


<span class="n">weights_filename</span> <span class="o">=</span> <span class="s2">"modelAE1-weights-sigmoid"</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">file_helper</span><span class="o">.</span><span class="n">load_model_weights</span><span class="p">(</span><span class="n">modelAE1_s</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">):</span>
    <span class="n">modelAE1_s</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span>
                   <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                   <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">))</span>
    <span class="n">file_helper</span><span class="o">.</span><span class="n">save_model_weights</span><span class="p">(</span><span class="n">modelAE1_s</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions1</span> <span class="o">=</span> <span class="n">modelAE1_s</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">draw_predictions_set</span><span class="p">(</span><span class="n">predictions1</span><span class="p">,</span> <span class="s1">'FCC1-s'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjgAAAD3CAYAAAAQVC6+AAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4wLCBo
dHRwOi8vbWF0cGxvdGxpYi5vcmcvpW3flQAAIABJREFUeJzt3XmQVcXZx/FnFEVxQURQQYIsgoCi
gmvcdyKCiqIWlDGaSDYrVmnUGM2mMVZpRbMZrSRlRY1ljHEJiBKNQYmlaNxQZBMUUIEIiohb3Ob9
J+n310/mtGfu3Htnbs/389dzqw9nztxzz52mn366m5qbmw0AACAnG7T3BQAAAFQbHRwAAJAdOjgA
ACA7dHAAAEB26OAAAIDs0MEBAADZoYMDAACyQwcHAABkhw4OAADITpfWHNzU1MSyx+2oubm5qa3n
4B62L+5h4+MeNj7uYeMrcw8ZwQEAANmhgwMAALJDBwcAAGSHDg4AAMgOHRwAAJAdOjgAACA7dHAA
AEB26OAAAIDstGqhP6Bavv3tb0evN9100xCPHDkyajvppJNaPMd1110XvX7sscdCfPPNN7f1EgEA
DYwRHAAAkB06OAAAIDt0cAAAQHaampvL7xfG5mLtq9E3iLvttttCXDSvpi2WLFkS4iOOOCJqW758
edV/XiUa/R7W2pAhQ0K8YMGCqO2cc84J8S9/+cu6XZPXWe7hZpttFr2+6qqrQvzVr341xE899VR0
3MSJE0O8bNmyGl1d23SWe5gzNtsEAACdEh0cAACQHcrEUTOakjIrn5byqYm//vWvIR44cGCIx40b
Fx03aNCgEE+ePDlqu+KKK0r9bLSvPfbYI8Sffvpp1Pbqq6/W+3I6te233z56fdZZZ4VY783o0aOj
44499tgQX3vttTW6OvzXqFGjotd33nlniHfcccea/uyjjjoqej1//vwQv/LKKzX92WUwggMAALJD
BwcAAGSHDg4AAMgOc3BQVXvuuWeITzjhhMLjXnjhhej1+PHjQ7xmzZqo7Z133gnxxhtvHOLZs2dH
x+22224h7tmzZ8krRkey++67h/jdd9+N2u666656X06n06tXrxDfeOON7XglKOvoo4+OXnft2rVu
P9vPgzzzzDNDfOqpp9btOoowggMAALJDBwcAAGSn3VNUWjqsZYgrVqyIjvvggw9CfMstt0Rtq1at
CvHixYurfYloBS0tbWqKF5rUtJQfVl25cmWp85933nkhHj58eOFx06dPL3U+tK9ddtklen322WeH
mB3ha+9b3/pW9Pr4448P8d57713ROQ866KAQb7BB/H/oOXPmhHjWrFkVnR9mXbr8/5/uY445pt2u
w69ife6554ZYV8L26eZ6YQQHAABkhw4OAADITrunqK688soQl111UTd6MzNbv359iH11Tq3p6qr6
uzz55JN1vY6OYtq0aSEePHhw1Kb36c0336zo/Dozf6ONNqroHOg4dt555+i1Dmv7lbBRfddcc030
2q8eXYkJEya0GJvFm2+ecsopUZtPd6DYoYceGuL99tsvatO/Q7XWo0eP6LVOG+jWrVuISVEBAABU
CR0cAACQHTo4AAAgO+0+B0dLw0eOHBli3ZXUzGzYsGEh9runHnLIISHed999ozbd0bRfv36lrunj
jz+OXq9evTrEfoddtXz58hB31jk4SvPtbXH++eeHeMiQIYXHPf744y3G6LguuOCC6LV+ZniGauPe
e+8NsS/jrsQbb7wRvdaVx/v37x+1DRgwIMRPPPFE1Lbhhhu2+Vpy5ZdTuPXWW0O8ZMmSqO0nP/lJ
Xa7JzOy4446r28+qBCM4AAAgO3RwAABAdto9RfXggw+2GHszZswobNNSNd2szywuPdxrr71KXZOu
mmxmtmjRohD71NnWW28dYj9UiMoce+yx0etLL700xLrZ5uuvvx4dd9FFF4X4vffeq9HVoa10OQjd
nNUsftbaq7Q0NwcffHD0eujQoSH2ZeFly8Svv/76EN9///1R27p160J82GGHRW0XX3xx4Tm//vWv
h/i6664rdR2dxSWXXBK91uUUxowZE7VpirAW9G+e/2xVY5mBamIEBwAAZIcODgAAyA4dHAAAkJ12
n4NTDWvXrg3xzJkzC49LzfFJOfHEE0Psl6Z+/vnnQ8zS8tXh52XovBvl3++HH364ZteE6vF5e6VL
MqByOs/pj3/8Y9S2zTbblDqHX+bhjjvuCPGPfvSjEKfmu/lzTJkyJcS9evWK2nSLgU022STEv/rV
r6LjPvroo9RlZ+Okk04Ksd8xfPHixSGu93IKOo/Kz7l56KGHQvzWW2/V65IKMYIDAACyQwcHAABk
J4sUVbX17t07ev3rX/86xH7lTy1hrnSHbJjdfffdIT7qqKMKj7vppptC7Esn0Rh23XXXwrZ67oSc
sy5d/v+rvWxKyixO85566qlR25o1a1p9HT5FdcUVV4T46quvjtp092n9HEydOjU6rrMsxzFx4sQQ
63tjFv9NqjVNd5qZTZ48OcSffPJJ1PbjH/84xB0hlcgIDgAAyA4dHAAAkB06OAAAIDvMwWnBN7/5
zei1ljNqSbqZ2cKFC+tyTbnxu7J//vOfD3HXrl2jNs39a4631kuSo3r23XffEJ9xxhkhfuaZZ6Lj
HnjggbpdE/63xPjMM88McSVzbj6LzqfRuRxm5bfSyVn37t1DrM+MV8+tLLS03yye0+W3Lkot09Ie
GMEBAADZoYMDAACyQ4rqP/bff/8Qf+c73yk87vjjj49ez507t2bXlDNdFdXMrGfPnoXH/uEPfwhx
ZykRzc0RRxwRYt2NeMaMGdFxH3zwQd2uqbPwS1uoffbZp45XYtbU1BRif11F1/nDH/4wen3aaadV
/bo6Ck3P9+3bN8S33npre1yOmZkNGjSosK2j//1jBAcAAGSHDg4AAMgOKar/0M3MNtpoo6hNN+l8
7LHH6nZNuRk/fnyIR40aVXicbthmZvaDH/ygVpeEOtltt91C3NzcHOI///nP7XE52fva174WYr8h
YnsaN25ciPfYY4+oTa9TY5+iytn69etD/Oyzz4Z45MiR0XGa5q3FCvq6mr9u+uk98sgjVf/Z1cQI
DgAAyA4dHAAAkB06OAAAIDuddg7OpptuGr0eM2ZMiD/88MOoTeeAdIQdUhuFL/3+7ne/G2I/z0lp
7tmMFYsb0XbbbRe9PvDAA0Osq3/fdddddbumzkTnutSbrvw+fPjwqE2/A1JWr14d4s70nfv++++H
WJfEOPHEE6Pjpk+fHmK/K3tZu+yyS4gHDhwYtekO4jpnzutI87tawggOAADIDh0cAACQnU6bojr/
/POj11qy6FdXffTRR+tyTbk577zzotepzfTuvvvuEFMW3vi+9KUvRa+17PS+++6r89Wgni6++OIQ
+42LU5YuXRri008/PcTLly+vynU1Gv0e1BWgzczGjh0b4kpXOdbNVH0aSjfUTPn9739f0c+uF0Zw
AABAdujgAACA7NDBAQAA2elUc3A0b/m9730vanv77bdDfOmll9btmnJ27rnnlj727LPPDjFl4Y2v
f//+hW1r166t45Wg1u69997o9dChQys6z7x580Lc0bcAqIcFCxaE+OSTT47adt999xAPHjy4ovOn
tkm58cYbQzx58uTC47SsvSNiBAcAAGSHDg4AAMhO9ikqXU33F7/4RYg33HDD6DgdZp09e3btLwwR
3R230pVL161bV3gOXTm5e/fuhefYaqutQtyaFNsnn3wS4gsvvDBqe++990qfJxfHHntsYdu0adPq
eCWdk5YVb7BB8f9jv/CFLxS2/eY3v4le9+nTp8Xj/PkrXd22PVdfbjS62rtf+b0aXnrppVLH6WrI
ZmZz586t+rW0BSM4AAAgO3RwAABAdujgAACA7GQ3B8fPrdFtFwYMGBBi3anV7H/LxlFfzz33XJvP
cfvtt4d45cqVUdu2224b4lNOOaXNPytl1apV0evLL7+8pj+vozjggANC7HcTR31dd911Ib7yyisL
j7vnnnui16n5M2Xn1pQ97vrrry91HOpP53D5bSJUR5tz4zGCAwAAskMHBwAAZCe7FNWgQYOi16NH
j27xOF8C7FNWaDu/wulxxx1X0583ceLEiv7dxx9/HOLU8PrUqVND/OSTTxYe949//KOi62h0J5xw
Qoh9qviZZ54J8axZs+p2TZ3VnXfeGeLzzz8/auvVq1dNf/bq1atDPH/+/KhtypQpIfZpZHQcuru4
32m8kTCCAwAAskMHBwAAZCeLFJVu7Hf//fcXHqdDtb56ANU3YcKE6PUFF1wQYl1Z+LOMGDEixGUr
oG644Ybo9dKlSwuPveOOO0KsG9whrVu3btHrY445pvBY3dhPV31GbSxbtizEp556atR2/PHHh/ic
c86p+s/WqsFrr7226udH7W2yySaFbR19g03FCA4AAMgOHRwAAJAdOjgAACA7Ta0pAWtqauqQ9WKa
873ooosKj9t7771DnCrz7aiam5uLl5QsqaPew84ip3vo51E9/PDDIX799dejtkmTJoW40XdXz+ke
jhkzJnqtZdx+d29dJkF3Gvcr3c6bNy/Ey5cvr8p1VltO97AWdDX2Ll3iqbqXXXZZiH/+85/X7Zq8
MveQERwAAJAdOjgAACA7DZmi0k39zOIVczfffPPCf0eKquPcw86Ke9j4uIeNj3uYNm3atBBfffXV
UdvMmTPrfTktIkUFAAA6JTo4AAAgO3RwAABAdhpyq4YDDzwwep2ad6O7hL/zzjs1uyYAAHLglwho
VIzgAACA7NDBAQAA2WnIFFXKnDlzoteHH354iN988816Xw4AAGgHjOAAAIDs0MEBAADZoYMDAACy
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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>

<span class="n">filepath</span> <span class="o">=</span> <span class="n">file_helper</span><span class="o">.</span><span class="n">get_input_file_path</span><span class="p">(</span><span class="s2">"pavlos-gray-28-28.png"</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> 
<span class="n">pix</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">pavlos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">784</span><span class="p">))</span>
<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">28</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">28</span><span class="p">):</span>
        <span class="n">pavlos</span><span class="p">[</span><span class="mi">0</span><span class="p">,(</span><span class="n">y</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">pix</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">255.</span>
        
<span class="n">predicted_pavlos</span> <span class="o">=</span> <span class="n">modelAE1_s</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pavlos</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">pavlos</span><span class="p">,</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">predicted_pavlos</span><span class="p">,</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">file_helper</span><span class="o">.</span><span class="n">save_figure</span><span class="p">(</span><span class="s1">'Model-FCC-pavlos-pair'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg"><ipython-input-10-ab6f6ee66143></span> in <span class="ansi-cyan-fg"><module></span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> 
<span class="ansi-green-intense-fg ansi-bold">      3</span> filepath <span class="ansi-blue-fg">=</span> file_helper<span class="ansi-blue-fg">.</span>get_input_file_path<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"pavlos-gray-28-28.png"</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----> 4</span><span class="ansi-red-fg"> </span>im <span class="ansi-blue-fg">=</span> Image<span class="ansi-blue-fg">.</span>open<span class="ansi-blue-fg">(</span>filepath<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> pix <span class="ansi-blue-fg">=</span> im<span class="ansi-blue-fg">.</span>load<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> pavlos <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>zeros<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">784</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.6/site-packages/PIL/Image.py</span> in <span class="ansi-cyan-fg">open</span><span class="ansi-blue-fg">(fp, mode)</span>
<span class="ansi-green-intense-fg ansi-bold">   2475</span> 
<span class="ansi-green-intense-fg ansi-bold">   2476</span>     <span class="ansi-green-fg">if</span> filename<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-> 2477</span><span class="ansi-red-fg">         </span>fp <span class="ansi-blue-fg">=</span> builtins<span class="ansi-blue-fg">.</span>open<span class="ansi-blue-fg">(</span>filename<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">"rb"</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2478</span>         exclusive_fp <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span>
<span class="ansi-green-intense-fg ansi-bold">   2479</span> 

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: '../data/pavlos-gray-28-28.png'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># rebuild model with the Functional API so we can play with the decoder alone</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Input</span>

<span class="n">num_latent_vars</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">model_encoder_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">784</span><span class="p">,))</span>
<span class="n">model_encoder_512</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)</span>
<span class="n">model_encoder_256</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)</span>
<span class="n">model_encoder_latent</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">num_latent_vars</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)</span>

<span class="n">model_decoder_256</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)</span>
<span class="n">model_decoder_512</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)</span>
<span class="n">model_decoder_out</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">)</span>

<span class="n">model_encoder_step_1</span> <span class="o">=</span> <span class="n">model_encoder_512</span><span class="p">(</span><span class="n">model_encoder_input</span><span class="p">)</span>
<span class="n">model_encoder_step_2</span> <span class="o">=</span> <span class="n">model_encoder_256</span><span class="p">(</span><span class="n">model_encoder_step_1</span><span class="p">)</span>
<span class="n">model_encoder_output</span> <span class="o">=</span> <span class="n">model_encoder_latent</span><span class="p">(</span><span class="n">model_encoder_step_2</span><span class="p">)</span>

<span class="n">model_decoder_step_1</span> <span class="o">=</span> <span class="n">model_decoder_256</span><span class="p">(</span><span class="n">model_encoder_output</span><span class="p">)</span>
<span class="n">model_decoder_step_2</span> <span class="o">=</span> <span class="n">model_decoder_512</span><span class="p">(</span><span class="n">model_decoder_step_1</span><span class="p">)</span>
<span class="n">model_decoder_output</span> <span class="o">=</span> <span class="n">model_decoder_out</span><span class="p">(</span><span class="n">model_decoder_step_2</span><span class="p">)</span>

<span class="n">model_AE_F</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_encoder_input</span><span class="p">,</span> <span class="n">model_decoder_output</span><span class="p">)</span>

<span class="n">model_encoder_only_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_encoder_input</span><span class="p">,</span> <span class="n">model_encoder_output</span><span class="p">)</span>

<span class="n">model_decoder_only_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_latent_vars</span><span class="p">,))</span>
<span class="n">model_decoder_only_step_1</span> <span class="o">=</span> <span class="n">model_decoder_256</span><span class="p">(</span><span class="n">model_decoder_only_input</span><span class="p">)</span>
<span class="n">model_decoder_only_step_2</span> <span class="o">=</span> <span class="n">model_decoder_512</span><span class="p">(</span><span class="n">model_decoder_only_step_1</span><span class="p">)</span>
<span class="n">model_decoder_only_output</span> <span class="o">=</span> <span class="n">model_decoder_out</span><span class="p">(</span><span class="n">model_decoder_only_step_2</span><span class="p">)</span>
<span class="n">model_decoder_only_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_decoder_only_input</span><span class="p">,</span> <span class="n">model_decoder_only_output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_AE_F</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adadelta'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'binary_crossentropy'</span><span class="p">)</span>

<span class="n">weights_filename</span> <span class="o">=</span> <span class="s2">"model-AE-F-weights"</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">file_helper</span><span class="o">.</span><span class="n">load_model_weights</span><span class="p">(</span><span class="n">model_AE_F</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">):</span>
    <span class="n">model_AE_F</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span>
               <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">))</span>
    <span class="n">file_helper</span><span class="o">.</span><span class="n">save_model_weights</span><span class="p">(</span><span class="n">model_AE_F</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># show the input data, its latent values, and the corresponding predicted images</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
<span class="n">encoder_predictions</span> <span class="o">=</span> <span class="n">model_encoder_only_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">latent_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">latent_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="p">[])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">latent_min</span><span class="p">,</span> <span class="n">latent_max</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">decoder_model_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
    <span class="n">decoder_prediction</span> <span class="o">=</span> <span class="n">model_decoder_only_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">decoder_model_input</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">decoder_prediction</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">file_helper</span><span class="o">.</span><span class="n">save_figure</span><span class="p">(</span><span class="s2">"model-F-latents-and-output"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># show the latent values and the corresponding predicted images</span>
<span class="c1"># this makes big vertical spaces between the </span>
<span class="k">def</span> <span class="nf">show_latents_and_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">latent_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
    <span class="n">latent_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="p">[])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">latent_min</span><span class="p">,</span> <span class="n">latent_max</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">decoder_model_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
        <span class="n">decoder_prediction</span> <span class="o">=</span> <span class="n">model_decoder_only_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">decoder_model_input</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">decoder_prediction</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">file_helper</span><span class="o">.</span><span class="n">save_figure</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># add [-noise to all values</span>
<span class="n">encoder_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">model_encoder_only_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
        <span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="n">noise</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">noise</span><span class="p">)</span>
<span class="n">show_latents_and_predictions</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">,</span> <span class="s1">'NB2-MLP-AE5-prediction-latent-values-with-noise-1'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

    </main>

<footer class="footer">
  <div class="container">
    <span class="text-muted">Copyright 2018 &copy;
      <a class="text-muted" href="https://iacs.seas.harvard.edu/">Institute for Applied Computational Science</a>
    </span>
  </div>
</footer>

    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
  </body>
</html>